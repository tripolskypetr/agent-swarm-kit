<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="1107.35546875" height="995" viewBox="0 0 1107.35546875 995" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-label="Flowchart depicting message processing with policy enforcement">
  <style>
    .flowchart { font-family: Arial, sans-serif; font-size: 14px; fill: #1a1a1a; }
    .node rect { fill: #f0f4f8; stroke: #333333; stroke-width: 1px; }
    .node text { fill: #1a1a1a; text-anchor: middle; font-size: 12px; }
    .cluster rect { fill: #e6ecf3; stroke: #333333; stroke-width: 1px; }
    .cluster text { fill: #1a1a1a; font-size: 14px; }
    .edgePath { stroke: #333333; stroke-width: 2px; fill: none; }
    .edgeLabel rect { fill: #f0f4f8; opacity: 0.8; }
    .edgeLabel text { fill: #1a1a1a; font-size: 10px; }
    .arrowMarker { fill: #333333; stroke: #333333; }
  </style>
  <defs>
    <marker id="arrowEnd" markerWidth="8" markerHeight="8" refX="5" refY="5" orient="auto" markerUnits="userSpaceOnUse" viewBox="0 0 10 10">
      <path d="M0 0 L10 5 L0 10 Z" class="arrowMarker"/>
    </marker>
  </defs>
  <g>
    <!-- Clusters -->
    <g class="cluster" id="subGraph0" aria-label="Incoming Message Flow Cluster">
      <rect x="339.3203125" y="8" width="425.25390625" height="746"/>
      <text x="467.025390625" y="28" text-anchor="middle">Incoming Message Flow</text>
    </g>
    <g class="cluster" id="subGraph1" aria-label="Outgoing Message Flow Cluster">
      <rect x="8" y="393" width="311.3203125" height="594"/>
      <text x="77.99609375" y="413" text-anchor="middle">Outgoing Message Flow</text>
    </g>
    <g class="cluster" id="subGraph2" aria-label="Policy Enforcement Cluster">
      <rect x="784.57421875" y="650" width="314.78125" height="337"/>
      <text x="874.72265625" y="670" text-anchor="middle">Policy Enforcement</text>
    </g>
    <!-- Nodes -->
    <g class="node" id="flowchart-IncomingMsg-0" transform="translate(566.5078125, 72)" aria-label="Incoming Message Node">
      <rect x="-125.40625" y="-39" width="250.8125" height="78"/>
      <text x="0" y="-10">Incoming Message<br/>{clientId, data, agentName}</text>
    </g>
    <g class="node" id="flowchart-PolicyValidateIn-1" transform="translate(566.5078125, 188)" aria-label="Policy Validate Input Node">
      <rect x="-102.9296875" y="-27" width="205.859375" height="54"/>
      <text x="0" y="0">Policy.validateInput()</text>
    </g>
    <g class="node" id="flowchart-SwarmExecute-2" transform="translate(491.79296875, 316)" aria-label="Swarm Execute Node">
      <rect x="-87.375" y="-27" width="174.75" height="54"/>
      <text x="0" y="0">Swarm.execute()</text>
    </g>
    <g class="node" id="flowchart-AgentExecution-3" transform="translate(491.79296875, 445)" aria-label="Agent Processing Node">
      <rect x="-91.28125" y="-27" width="182.5625" height="54"/>
      <text x="0" y="0">Agent Processing</text>
    </g>
    <g class="node" id="flowchart-PolicyValidateOut-4" transform="translate(491.79296875, 549)" aria-label="Policy Validate Output Node">
      <rect x="-109.5390625" y="-27" width="219.078125" height="54"/>
      <text x="0" y="0">Policy.validateOutput()</text>
    </g>
    <g class="node" id="flowchart-OutgoingMsg-5" transform="translate(491.79296875, 702)" aria-label="Response to Client Node">
      <rect x="-95.65625" y="-27" width="191.3125" height="54"/>
      <text x="0" y="0">Response to Client</text>
    </g>
    <g class="node" id="flowchart-EmitCall-6" transform="translate(174.78125, 445)" aria-label="Session Emit Node">
      <rect x="-108.6328125" y="-27" width="217.265625" height="54"/>
      <text x="0" y="0">session.emit(message)</text>
    </g>
    <g class="node" id="flowchart-PolicyValidateEmit-7" transform="translate(174.78125, 549)" aria-label="Policy Validate Emit Node">
      <rect x="-109.5390625" y="-27" width="219.078125" height="54"/>
      <text x="0" y="0">Policy.validateOutput()</text>
    </g>
    <g class="node" id="flowchart-SwarmEmit-8" transform="translate(144.6875, 702)" aria-label="Swarm Emit Node">
      <rect x="-75.9453125" y="-27" width="151.890625" height="54"/>
      <text x="0" y="0">Swarm.emit()</text>
    </g>
    <g class="node" id="flowchart-BusEvent-9" transform="translate(144.6875, 831)" aria-label="Bus Service Emit Node">
      <rect x="-89.65625" y="-27" width="179.3125" height="54"/>
      <text x="0" y="0">BusService.emit()</text>
    </g>
    <g class="node" id="flowchart-ClientNotification-10" transform="translate(144.6875, 935)" aria-label="Client Notification Node">
      <rect x="-93.8359375" y="-27" width="187.671875" height="54"/>
      <text x="0" y="0">Client Notification</text>
    </g>
    <g class="node" id="flowchart-BanCheck-11" transform="translate(941.96484375, 702)" aria-label="Policy Ban Check Node">
      <rect x="-89.21875" y="-27" width="178.4375" height="54"/>
      <text x="0" y="0">Policy Ban Check</text>
    </g>
    <g class="node" id="flowchart-BanMessage-12" transform="translate(941.96484375, 831)" aria-label="Ban Message Node">
      <rect x="-90.7421875" y="-27" width="181.484375" height="54"/>
      <text x="0" y="0">getBanMessage()</text>
    </g>
    <g class="node" id="flowchart-BanPlaceholder-13" transform="translate(941.96484375, 935)" aria-label="Ban Placeholder Response Node">
      <rect x="-122.390625" y="-27" width="244.78125" height="54"/>
      <text x="0" y="0">Ban Placeholder Response</text>
    </g>
    <!-- Edges -->
    <g class="edgePaths">
      <path class="edgePath" id="L_IncomingMsg_PolicyValidateIn_0" d="M566.508,111L566.508,157" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_PolicyValidateIn_SwarmExecute_0" d="M534.987,215L527.788,221.167C520.589,227.333,506.191,239.667,498.992,251.333C491.793,263,491.793,274,491.793,279.5L491.793,285" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_PolicyValidateIn_BanCheck_0" d="M598.028,215L605.227,221.167C612.426,227.333,626.824,239.667,634.024,256.5C641.223,273.333,641.223,294.667,641.223,314C641.223,333.333,641.223,350.667,641.223,363.5C641.223,376.333,641.223,384.667,641.223,397.5C641.223,410.333,641.223,427.667,641.223,445C641.223,462.333,641.223,479.667,641.223,497C641.223,514.333,641.223,531.667,641.223,551C641.223,570.333,641.223,591.667,641.223,608.5C641.223,625.333,641.223,637.667,675.82,649.815C710.417,661.964,779.611,673.928,814.208,679.91L848.805,685.892" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_BanCheck_BanMessage_0" d="M941.965,729L941.965,800" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_BanMessage_BanPlaceholder_0" d="M941.965,858L941.965,904" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_SwarmExecute_AgentExecution_0" d="M491.793,343L491.793,414" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_AgentExecution_PolicyValidateOut_0" d="M491.793,472L491.793,518" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_PolicyValidateOut_OutgoingMsg_0" d="M491.793,576L491.793,671" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_PolicyValidateOut_BanCheck_0" d="M573.037,576L591.593,582.167C610.148,588.333,647.26,600.667,665.815,613C684.371,625.333,684.371,637.667,711.78,649.366C739.189,661.066,794.007,672.132,821.416,677.665L848.825,683.198" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_EmitCall_PolicyValidateEmit_0" d="M174.781,472L174.781,518" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_PolicyValidateEmit_SwarmEmit_0" d="M162.085,576L159.186,582.167C156.286,588.333,150.487,600.667,147.587,613C144.688,625.333,144.688,637.667,144.688,647.333C144.688,657,144.688,664,144.688,671" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_PolicyValidateEmit_BanCheck_0" d="M196.168,576L201.053,582.167C205.938,588.333,215.707,600.667,220.592,613C225.477,625.333,225.477,637.667,329.357,651.373C433.237,665.078,640.997,680.157,744.877,687.696L848.757,695.235" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_SwarmEmit_BusEvent_0" d="M144.688,729L144.688,800" marker-end="url(#arrowEnd)"/>
      <path class="edgePath" id="L_BusEvent_ClientNotification_0" d="M144.688,858L144.688,904" marker-end="url(#arrowEnd)"/>
    </g>
    <!-- Edge Labels -->
    <g class="edgeLabels">
      <g transform="translate(566.508, 135)" aria-label="Edge from Incoming Message to Policy Validate Input">
        <text x="0" y="0">Message Received</text>
      </g>
      <g transform="translate(491.79296875, 252)" aria-label="Edge from Policy Validate Input to Swarm Execute">
        <text x="0" y="0">Valid</text>
      </g>
      <g transform="translate(641.22265625, 445)" aria-label="Edge from Policy Validate Input to Ban Check">
        <text x="0" y="0">Invalid</text>
      </g>
      <g transform="translate(941.965, 765)" aria-label="Edge from Ban Check to Ban Message">
        <text x="0" y="0">Ban Detected</text>
      </g>
      <g transform="translate(941.965, 881)" aria-label="Edge from Ban Message to Ban Placeholder">
        <text x="0" y="0">Ban Response</text>
      </g>
      <g transform="translate(491.793, 379)" aria-label="Edge from Swarm Execute to Agent Execution">
        <text x="0" y="0">Execution</text>
      </g>
      <g transform="translate(491.793, 495)" aria-label="Edge from Agent Execution to Policy Validate Output">
        <text x="0" y="0">Processed</text>
      </g>
      <g transform="translate(491.793, 625)" aria-label="Edge from Policy Validate Output to Outgoing Message">
        <text x="0" y="0">Valid</text>
      </g>
      <g transform="translate(684.37109375, 625)" aria-label="Edge from Policy Validate Output to Ban Check">
        <text x="0" y="0">Invalid</text>
      </g>
      <g transform="translate(174.781, 495)" aria-label="Edge from Emit Call to Policy Validate Emit">
        <text x="0" y="0">Emit Request</text>
      </g>
      <g transform="translate(144.6875, 625)" aria-label="Edge from Policy Validate Emit to Swarm Emit">
        <text x="0" y="0">Valid</text>
      </g>
      <g transform="translate(225.4765625, 625)" aria-label="Edge from Policy Validate Emit to Ban Check">
        <text x="0" y="0">Invalid</text>
      </g>
      <g transform="translate(144.688, 765)" aria-label="Edge from Swarm Emit to Bus Event">
        <text x="0" y="0">Event Emitted</text>
      </g>
      <g transform="translate(144.688, 881)" aria-label="Edge from Bus Event to Client Notification">
        <text x="0" y="0">Notify Client</text>
      </g>
    </g>
  </g>
</svg>